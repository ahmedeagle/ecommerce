/*!
 * stack-admin-theme (https://pixinvent.com/bootstrap-admin-template/stack)
 * Copyright 2018 PIXINVENT
 * Licensed under the Themeforest Standard Licenses
 */
$(window).on("load",function(){function resize(){width=ele.node().getBoundingClientRect().width-margin.left-margin.right,container.attr("width",width+margin.left+margin.right),svg.attr("width",width+margin.left+margin.right),x.range([0,width]),svg.selectAll(".d3-xaxis").call(xAxis),svg.selectAll(".d3-line").attr("d",line)}var ele=d3.select("#nested-donut"),margin={top:20,right:10,bottom:20,left:10},width=300,height=300;radius=(Math.min(width,height)-2*margin.top)/2;var colors=d3.scale.ordinal().range(["#99B898","#FECEA8","#FF847C","#E84A5F","#F8B195","#F67280","#C06C84"]);d3.csv("../../../app-assets/data/d3/pie/flights.csv",function(flights){function angle(d){var a=90*(d.startAngle+d.endAngle)/Math.PI-90;return a>90?a-180:a}var airports=d3.nest().key(function(d){return d.origin}).entries(flights),svg=ele.selectAll("svg").data(airports).enter().append("svg").attr("width",2*(radius+margin.left+margin.right)).attr("height",2*(radius+margin.left+margin.right)).append("g").attr("transform","translate("+(radius+margin.left+margin.right)+","+(radius+margin.left+margin.right)+")"),arc=d3.svg.arc().innerRadius(radius/2).outerRadius(radius),pie=d3.layout.pie().value(function(d){return+d.count}).sort(function(a,b){return b.count-a.count});svg.append("text").attr("dy",".35em").style("text-anchor","middle").style("font-weight",500).text(function(d){return d.key});var g=svg.selectAll("g").data(function(d){return pie(d.values)}).enter().append("g").attr("class","d3-arc");g.append("path").attr("d",arc).style("stroke","#fff").style("fill",function(d){return colors(d.data.carrier)}).append("title").text(function(d){return d.data.carrier+": "+d.data.count}),g.filter(function(d){return d.endAngle-d.startAngle>.2}).append("text").attr("dy",".35em").attr("transform",function(d){return"translate("+arc.centroid(d)+")rotate("+angle(d)+")"}).style("fill","#fff").style("font-size",12).style("text-anchor","middle").text(function(d){return d.data.carrier})}),$(window).on("resize",resize),$(".menu-toggle").on("click",resize)});